<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<section
  th:fragment="auctionFilter(totalCount, q, sort, sortOptions)"
  class="auction-filter"
>
  <form id="auctionFilterForm"
        method="get"
        class="auction-filter-form"
        th:action="@{/auctions}">
    <input type="hidden" name="sort" id="sortInput" th:value="${sort}" value="" />

    <div class="filter-container">
      <!-- 1줄: 총 개수 + 검색 + 우측 컨트롤 -->
      <div class="filter-row">
        <!-- 좌측: 총 개수 -->
        <div class="filter-total">
          <span class="filter-total-label">총</span>
          <span class="filter-total-count"
                th:text="${totalCount != null ? #numbers.formatInteger(totalCount, 0, 'COMMA') : ''}">
          </span>
          <span class="filter-total-label">개</span>
        </div>

        <!-- 중앙: 검색 -->
        <div class="filter-search-wrapper">
          <div class="filter-search-container">
            <input
              type="search"
              name="q"
              id="qInput"
              th:value="${q}"
              value=""
              placeholder="현재 카테고리에서 검색"
              class="filter-search-input"
            />
            <button type="submit"
                    class="filter-search-btn"
                    aria-label="검색">
              <!-- search icon -->
              <svg xmlns="http://www.w3.org/2000/svg" class="filter-search-icon" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="m21 21-4.35-4.35m1.35-5.65a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- 우측: 정렬 드롭다운 -->
        <div class="filter-controls">
          <!-- 정렬 (커스텀 드롭다운: 이미지처럼) -->
          <div class="dropdown" data-dropdown="sort">
            <button type="button"
                    class="dropdown-toggle"
                    aria-haspopup="listbox"
                    aria-expanded="false">
              <span class="dropdown-label"
                    th:text="${(sortOptions != null and !sortOptions.isEmpty()) ? '' : '정렬'}">
                <!-- 초기 라벨은 JS에서 sortInput/옵션 기준으로 갱신 -->
                정렬
              </span>
              <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-icon" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="m19 9-7 7-7-7"/>
              </svg>
            </button>

            <div class="dropdown-menu hidden"
                 role="listbox">
              <div class="dropdown-menu-inner">
                <!-- 옵션은 사용자께서 채우기: sortOptions -->
                <button type="button"
                        class="dropdown-item"
                        th:each="opt : ${sortOptions}"
                        th:attr="data-value=${opt.value}"
                        th:text="${opt.label}">
                </button>

                <!-- sortOptions가 비어있을 때(개발 단계) 보여줄 placeholder -->
                <div class="dropdown-placeholder"
                     th:if="${sortOptions == null or sortOptions.isEmpty()}">
                  정렬 옵션을 주입하세요.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</section>
</body>
</html>
