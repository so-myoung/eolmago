<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/base}">
<head>
    <title layout:fragment="title">리뷰 상세</title>
</head>

<body>
<div layout:fragment="content">
    <div class="max-w-3xl mx-auto space-y-6">
        <!-- 헤더 -->
        <div class="flex items-start justify-between gap-4">
            <div>
                <h1 class="text-3xl font-extrabold tracking-tight text-gray-900">리뷰 상세</h1>
                <p class="mt-2 text-sm text-gray-600">
                    거래 완료 후 작성된 리뷰를 확인합니다.
                </p>
            </div>

            <div class="flex gap-2">
                <a th:href="${role == 'BUYER' ? '/buyer/deals' : '/seller/deals'}"
                   class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                    목록으로
                </a>
                <a th:href="${role == 'BUYER' ? '/buyer/deals/' + dealId : '/seller/deals/' + dealId}"
                   class="inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-slate-900 hover:bg-black">
                    거래 상세
                </a>
            </div>
        </div>

        <!-- 리뷰 카드 -->
        <div class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6 space-y-6">
            <!-- 평점 -->
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-semibold text-gray-900">평점</p>
                    <div class="mt-2 flex items-center gap-1">
                        <!-- 1~5 별 -->
                        <span th:each="i : ${#numbers.sequence(1,5)}"
                              class="text-xl"
                              th:classappend="${review != null and review.rating != null and review.rating >= i} ? ' text-yellow-500' : ' text-gray-300'">
                            ★
                        </span>
                        <span class="ml-2 text-sm text-gray-600"
                              th:text="${review != null ? review.rating : '-'}">-</span>
                    </div>
                </div>

                <div class="text-right">
                    <p class="text-xs text-gray-500">작성일</p>
                    <p class="mt-1 text-sm font-medium text-gray-900"
                       th:text="${review != null ? review.createdAt : '-'}">-</p>
                </div>
            </div>

            <div class="border-t border-gray-200 pt-4">
                <p class="text-sm font-semibold text-gray-900">리뷰 내용</p>
                <p class="mt-2 text-sm text-gray-700 whitespace-pre-wrap"
                   th:text="${review != null ? review.content : '리뷰를 찾을 수 없습니다.'}">
                    -
                </p>
            </div>

            <!-- 작성자/대상 -->
            <div class="border-t border-gray-200 pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                <div class="bg-gray-50 rounded-lg p-4">
                    <p class="text-xs text-gray-500 mb-1">구매자</p>
                    <p class="font-medium text-gray-900"
                       th:text="${review != null ? review.buyerNickname : '-'}">-</p>
                </div>
                <div class="bg-gray-50 rounded-lg p-4">
                    <p class="text-xs text-gray-500 mb-1">판매자</p>
                    <p class="font-medium text-gray-900"
                       th:text="${review != null ? review.sellerNickname : '-'}">-</p>
                </div>
            </div>
        </div>

        <!-- 에러/빈 상태 안내(선택) -->
        <div th:if="${review == null}"
             class="text-center py-10 bg-gray-50 rounded-xl border border-gray-200">
            <p class="text-sm text-gray-700">리뷰 데이터가 없습니다.</p>
        </div>
    </div>
</div>
</body>
</html>
